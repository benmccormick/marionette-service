/**
 * Marionette Service
 *
 * Adds a Service Object to Marionette which allows an Object to
 * receive Backbone.Radio messages in a declarative fashion.
 *
 * @author Ben McCormick
 *
 */
{"version":3,"file":"marionette-service.js","sources":["marionette-service.js","/source/marionette-service.js"],"names":["global","factory","exports","module","require","define","amd","Marionette","Service","_","Mn","Radio","this","proxyRadioHandlers","unproxyRadioHandlers","apply","each","radioAPI","commands","radioType","hash","result","handler","radioMessage","normalizeHandler","call","messageComponents","split","channel","messageName","proxyRadioHandler","method","startMethod","_radioChannels","contains","push","stopMethod","isFunction","radioEvents","radioCommands","radioRequests","Object","constructor","destroy","marionette_service"],"mappings":"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","sourceRoot":"/source/","sourcesContent":["/**\n * Marionette Service\n *\n * Adds a Service Object to Marionette which allows an Object to\n * receive Backbone.Radio messages in a declarative fashion.\n *\n * @author Ben McCormick\n *\n */\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('underscore'), require('backbone.marionette'), require('backbone.radio')) :\n    typeof define === 'function' && define.amd ? define(['underscore', 'backbone.marionette', 'backbone.radio'], factory) :\n    global.Marionette.Service = factory(global._, global.Mn, global.Radio)\n}(this, function (_, Mn, Radio) { 'use strict';\n\n    var radioAPI = {\n        'radioEvents' : {\n            startMethod: 'on',\n            stopMethod: 'off'\n        },\n        'radioCommands' : {\n            startMethod: 'comply',\n            stopMethod: 'stopComplying'\n        },\n        'radioRequests' : {\n            startMethod: 'reply',\n            stopMethod: 'stopReplying'\n        }\n    };\n\n    function proxyRadioHandlers() {\n        unproxyRadioHandlers.apply(this);\n        _.each(radioAPI, function(commands, radioType) {\n            var hash = _.result(this, radioType);\n            if (!hash) {\n                return;\n            }\n            _.each(hash, function(handler, radioMessage) {\n                handler = normalizeHandler.call(this, handler);\n                if (!handler) {\n                  return;\n                }\n                var messageComponents = radioMessage.split(' '),\n                  channel = messageComponents[0],\n                  messageName = messageComponents[1];\n                proxyRadioHandler.call(this,channel, radioType, messageName, handler);\n            }, this);\n        }, this);\n    }\n\n    function proxyRadioHandler(channel, radioType, messageName, handler) {\n        var method = radioAPI[radioType].startMethod;\n        this._radioChannels = this._radioChannels || [];\n        if(!_.contains(this._radioChannels, channel)) {\n            this._radioChannels.push(channel);\n        }\n        Radio[method](channel, messageName, handler, this);\n    }\n\n    function unproxyRadioHandlers() {\n        _.each(this._radioChannels, function(channel) {\n            _.each(radioAPI,function(commands) {\n                Radio[commands.stopMethod](channel, null, null, this);\n            }, this);\n        }, this);\n    }\n\n    function normalizeHandler(handler) {\n        if (!_.isFunction(handler)) {\n            handler = this[handler];\n        }\n        return handler;\n    }\n\n    var Service = Mn.Object.extends({\n\n        constructor: function() {\n            Mn.Object.apply(this);\n            proxyRadioHandlers.apply(this);\n        },\n\n        destroy: function() {\n            Mn.Object.destroy.apply(this);\n            unproxyRadioHandlers.apply(this);\n        }\n\n    });\n\n    var marionette_service = Service;\n\n    return marionette_service;\n\n}));\n","/**\n * Marionette Service\n *\n * Adds a Service Object to Marionette which allows an Object to\n * receive Backbone.Radio messages in a declarative fashion.\n *\n * @author Ben McCormick\n *\n */\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('underscore'), require('backbone.marionette'), require('backbone.radio')) :\n    typeof define === 'function' && define.amd ? define(['underscore', 'backbone.marionette', 'backbone.radio'], factory) :\n    global.Marionette.Service = factory(global._, global.Mn, global.Radio)\n}(this, function (_, Mn, Radio) { 'use strict';\n\n    var radioAPI = {\n        'radioEvents' : {\n            startMethod: 'on',\n            stopMethod: 'off'\n        },\n        'radioCommands' : {\n            startMethod: 'comply',\n            stopMethod: 'stopComplying'\n        },\n        'radioRequests' : {\n            startMethod: 'reply',\n            stopMethod: 'stopReplying'\n        }\n    };\n\n    function proxyRadioHandlers() {\n        unproxyRadioHandlers.apply(this);\n        _.each(radioAPI, function(commands, radioType) {\n            var hash = _.result(this, radioType);\n            if (!hash) {\n                return;\n            }\n            _.each(hash, function(handler, radioMessage) {\n                handler = normalizeHandler.call(this, handler);\n                if (!handler) {\n                  return;\n                }\n                var messageComponents = radioMessage.split(' '),\n                  channel = messageComponents[0],\n                  messageName = messageComponents[1];\n                proxyRadioHandler.call(this,channel, radioType, messageName, handler);\n            }, this);\n        }, this);\n    }\n\n    function proxyRadioHandler(channel, radioType, messageName, handler) {\n        var method = radioAPI[radioType].startMethod;\n        this._radioChannels = this._radioChannels || [];\n        if(!_.contains(this._radioChannels, channel)) {\n            this._radioChannels.push(channel);\n        }\n        Radio[method](channel, messageName, handler, this);\n    }\n\n    function unproxyRadioHandlers() {\n        _.each(this._radioChannels, function(channel) {\n            _.each(radioAPI,function(commands) {\n                Radio[commands.stopMethod](channel, null, null, this);\n            }, this);\n        }, this);\n    }\n\n    function normalizeHandler(handler) {\n        if (!_.isFunction(handler)) {\n            handler = this[handler];\n        }\n        return handler;\n    }\n\n    var Service = Mn.Object.extends({\n\n        constructor: function() {\n            Mn.Object.apply(this);\n            proxyRadioHandlers.apply(this);\n        },\n\n        destroy: function() {\n            Mn.Object.destroy.apply(this);\n            unproxyRadioHandlers.apply(this);\n        }\n\n    });\n\n    var marionette_service = Service;\n\n    return marionette_service;\n\n}));\n"]}